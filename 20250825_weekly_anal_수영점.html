<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>주간 매출 분석 보고서</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { 
            --primary: #2c3e50; 
            --accent: #3498db; 
            --bg: #f4f7f6; 
            --card-bg: #fff; 
            --highlight: #fffce2; 
        }
        * { box-sizing: border-box; }
        
        body { font-family: 'Noto Sans KR', sans-serif; background: var(--bg); margin: 0; padding: 20px; color: #333; line-height: 1.6; }
        .container { max-width: 1400px; margin: 0 auto; width: 100%; } 
        
        header { background: var(--primary); color: #fff; padding: 20px; border-radius: 8px; margin-bottom: 20px; display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 15px; }
        header h1 { margin: 0; font-size: 1.5rem; }

        .card { background: var(--card-bg); border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); padding: 20px; margin-bottom: 20px; width: 100%; height: 100%; }
        .card h3 { margin-top: 0; border-bottom: 2px solid #eee; padding-bottom: 10px; color: var(--primary); font-size: 1.1rem; }
        
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .stat-box { background: #fff; padding: 20px; border-radius: 8px; text-align: center; border-top: 5px solid var(--accent); box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .stat-val { font-size: 1.5rem; font-weight: bold; color: var(--primary); margin: 8px 0; }

        .charts-row { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 20px; }
        .full-width { grid-column: span 2; }
        
        @media (max-width: 1000px) { .charts-row { grid-template-columns: 1fr; } .full-width { grid-column: span 1; } }

        .chart-container { position: relative; height: 350px; width: 100%; }
        
        .table-wrapper { width: 100%; overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; font-size: 0.9rem; min-width: 500px; }
        th, td { padding: 12px 10px; border-bottom: 1px solid #eee; text-align: left; }
        th { background: #f8f9fa; font-weight: 600; }

        .highlight-first td:nth-child(2) { background-color: var(--highlight); font-weight: bold; }
        
        .text-right { text-align: right; }
        .badge { background: #e8f4fd; color: #2980b9; padding: 3px 8px; border-radius: 4px; font-weight: bold; margin-right: 5px; font-size: 0.85rem; }

        .basket-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 10px; margin-top: 15px; }
        .basket-item { background: #f9f9f9; padding: 12px; border-radius: 6px; text-align: center; border: 1px solid #eee; }
        .basket-label { font-size: 0.85rem; color: #666; margin-bottom: 5px; }
        .basket-val { font-size: 1.1rem; font-weight: bold; color: var(--accent); }

        /* 변동폭 색상 추가 */
        .up { color: #e74c3c; font-weight: bold; }
        .down { color: #3498db; font-weight: bold; }

        /* --- AI Report Section Styles (Daily와 동일하게 변경) --- */
        .ai-report-section { border-top: 4px solid var(--accent); }
        .ai-content { padding: 10px 5px; }
        .ai-content h3, .ai-content h4 { color: var(--primary); margin-bottom: 15px; font-size: 1.2rem; }
        .ai-content p { margin-bottom: 10px; line-height: 1.8; color: #444; }
        .ai-content ul { padding-left: 20px; color: #555; }
        .ai-content li { margin-bottom: 8px; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1 id="doc-title">주간 매출 분석 보고서</h1>
            <div id="doc-meta" style="text-align: right; opacity: 0.9;"></div>
        </header>

        <div class="summary-grid">
            <div class="stat-box"><div>주간 총매출</div><div class="stat-val" id="total-sales">0</div><div id="sales-growth"></div></div>
            <div class="stat-box"><div>평균 일일매출</div><div class="stat-val" id="avg-daily-sales">0</div><div id="avg-sales-growth"></div></div>
            <div class="stat-box"><div>평균 일일 거래건수</div><div class="stat-val" id="avg-trx">0</div><div id="trx-growth"></div></div>
            <div class="stat-box"><div>평균 일일 객단가</div><div class="stat-val" id="avg-atv">0</div><div id="atv-growth"></div></div>
        </div>

        <div class="charts-row">
            <div class="card"><h3>5주간 매출 추이</h3><div class="chart-container"><canvas id="fiveWeekChart"></canvas></div></div>
            <div class="card"><h3>요일별 매출 (전주 비교)</h3><div class="chart-container"><canvas id="dayCompareChart"></canvas></div></div>
            <div class="card full-width"><h3>주간 시간대별 매출 및 객단가</h3><div class="chart-container"><canvas id="hourlyWeeklyChart"></canvas></div></div>
        </div>

        <div class="charts-row">
            <div class="card">
                <h3>요일별 Top 3 카테고리</h3>
                <div class="table-wrapper"><table id="day-top-table" class="highlight-first">
                    <thead><tr><th>요일</th><th>1위</th><th>2위</th><th>3위</th></tr></thead><tbody></tbody>
                </table></div>
            </div>
            <div class="card">
                <h3>주간 시간대별 Top 3 카테고리</h3>
                <div class="table-wrapper"><table id="hour-top-table" class="highlight-first">
                    <thead><tr><th>시간대</th><th>1위</th><th>2위</th><th>3위</th></tr></thead><tbody></tbody>
                </table></div>
            </div>
            <div class="card"><h3>주간 전체 Top 10 카테고리</h3><div class="chart-container"><canvas id="weeklyCatChart"></canvas></div></div>
            <div class="card">
                <h3>주간 Top 10 상품</h3>
                <div class="table-wrapper"><table id="top-item-table"><thead><tr><th>상품명</th><th class="text-right">매출액</th><th class="text-right">수량</th></tr></thead><tbody></tbody></table></div>
            </div>
        </div>

        <div class="charts-row">
            <div class="card">
                <h3>주간 카테고리 변동성 Top 5</h3>
                <div class="table-wrapper">
                    <table id="vol-cat-table">
                        <thead><tr><th>카테고리</th><th class="text-right">현재 점유율</th><th class="text-right">변동폭</th></tr></thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="card">
                <h3>주간 상품 변동성 Top 5</h3>
                <div class="table-wrapper">
                    <table id="vol-prod-table">
                        <thead><tr><th>상품명</th><th class="text-right">현재 점유율</th><th class="text-right">변동폭</th></tr></thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="card ai-report-section">
            <h3>주간 매출 및 변동성 분석</h3>
            <div class="ai-content">
                <div id="ai-space-1"><h4>주간 실적 종합 진단</h4>
<ul>
<li><strong>매출 흐름:</strong> 4주간 지속되던 상승세가 금주 -3.08%를 기록하며 <strong>하락 반전</strong>함. 객단가는 0.45% 소폭 상승했으나, <strong>객수(-3.52%)</strong>가 더 큰 폭으로 감소하며 전체 실적을 끌어내린 것이 핵심 문제임.</li>
<li><strong>요일별 분석:</strong> 전주 대비 매출 갭이 가장 큰 요일은 <strong>수요일(-1.39M)</strong>임. 수요일 Top5 카테고리인 밥류와 치킨 등의 실적이 주간 평균치에 못 미치며 주중 매출 방어에 실패함.</li>
<li><strong>총평:</strong> 유입 객수 감소에 따른 4주간의 성장세 중단 및 하락세 진입.</li>
</ul>
<h4>상품 및 카테고리 심층 분석</h4>
<ul>
<li><strong>수익원(Cash Cow):</strong> 매출 점유율 상위인 <strong>밥류(21.89%), 초밥(14.4%), 치킨(11.25%)</strong>이 전체 매출의 절반 가까이를 견인하는 확실한 수익원임.</li>
<li><strong>리스크 관리:</strong> 시즌 상품인 수박(점유율 19.2%)과 계란의 요일별 판매 변동성이 큼. 판매 데이터 기반의 정교한 예측 없이는 폐기 또는 품절 리스크가 높으므로, 차주에는 일일 단위로 재고를 확인하여 발주량을 탄력적으로 운용할 것을 지시함.</li>
</ul>
<h4>운영 효율화 전략</h4>
<ul>
<li><strong>골든타임 대응:</strong> 주간 최고 매출 시간대인 <strong>18:00~19:59</strong>에 밥류, 초밥, 치킨 수요가 집중됨. 매출 폭발 전인 <strong>15:30까지</strong> 해당 상품군의 진열을 120% 수준으로 완료하여 구매 기회 손실을 차단해야 함.</li>
<li><strong>인력/진열 제안:</strong> 주중 매출이 가장 높은 <strong>월요일</strong>과 매일 저녁 피크타임(16:00~22:00)에 인력을 집중 배치함. 16시를 기점으로 신선식품 코너를 저녁 식사 대용식 중심으로 재편할 것을 제안함.</li>
</ul>
<h4>차주 중점 과제</h4>
<ul>
<li><strong>재고:</strong> 매출 비중이 높은 밥류, 초밥 원재료 및 제철 과일(수박, 메론) 발주량 집중 관리.</li>
<li><strong>진열:</strong> 16시 이전 저녁 피크타임용 초밥 및 치킨 상품군 전면 배치 완료.</li>
<li><strong>접객:</strong> 18~20시 사이 결제 대기 시간 단축 및 "갓 조리된 치킨/초밥" 강조 멘트 시행.</li>
</ul></div>
            </div>
        </div>

        <div class="card">
            <h3>연관구매 분석</h3>
            <div class="charts-row">
                <div class="table-wrapper"><h4>빈도별 연관구매 (Top 5)</h4><table id="assoc-freq-table"><thead><tr><th>조합</th><th class="text-right">Support</th><th class="text-right">Lift</th></tr></thead><tbody></tbody></table></div>
                <div class="table-wrapper"><h4>매출별 연관구매 (Top 5)</h4><table id="assoc-sales-table"><thead><tr><th>조합</th><th class="text-right">총매출금</th></tr></thead><tbody></tbody></table></div>
            </div>
            <div class="table-wrapper" style="margin-top:20px;">
                <h4>주간 객단가별 연관구매 Top 3</h4>
                <table id="atv-assoc-table" class="highlight-first"><thead><tr><th>객단가 범위</th><th>1위 조합</th><th>2위 조합</th><th>3위 조합</th></tr></thead><tbody></tbody></table>
            </div>
        </div>

        <div class="card ai-report-section">
            <h3>구매 패턴 및 연관성 분석</h3>
            <div class="ai-content">
                <div id="ai-space-2"><h4>장바구니 조합 및 구매 패턴 분석</h4>
<ul>
<li><strong>보편적 구매 패턴(Support):</strong> '밥류'를 필두로 식사 대용식(식빵, 김밥, 컵라면)을 함께 구매하는 '간편 식사형' 패턴이 주를 이룸. 특히 밥류와 컵라면의 리프트(1.62)가 높아 식사 보완 관계가 뚜렷함.</li>
<li><strong>강한 결합(Lift):</strong> 맥주와 소주(9.52), 기타과일과 수박(4.005)의 리프트가 압도적임. 이는 단순 식사를 넘어 '음주'와 '계절 과일 섭취'라는 명확한 목적을 가진 동시 구매가 강력하게 발생하고 있음을 의미함.</li>
</ul>
<h4>매출 기여도 및 앵커(Anchor) 분석</h4>
<ul>
<li><strong>핵심 앵커:</strong> '밥류'는 전체 점유율 21.89%로 스낵, 치킨, 김밥 등 거의 모든 주요 카테고리의 판매를 견인하는 강력한 앵커 역할을 수행함. </li>
<li><strong>연결 누락 분석:</strong> '계란'은 매출 5위(8.25%)의 고매출 품목임에도 밥류와의 연관 구매 목록에서 식별되지 않음. 이는 계란이 조리용 식재료로만 소비되고 있음을 뜻하며, 덮밥류 구매 시 계란 후라이 추가 제안 등 즉석 섭취 상품과의 연결 고리 강화가 필요함.</li>
</ul>
<h4>객단가 구간별 이동 전략</h4>
<ul>
<li><strong>구간별 특징:</strong> 2만 원 미만 구간은 '밥류+김밥/면' 등 필수 식사 위주이나, 2만 원 이상 구간부터 '스낵, 치킨, 과일' 등 기호품이 추가되며 객단가가 상승함.</li>
<li><strong>상승 전략:</strong> 1만 원대 고객에게 '식사+디저트(스낵/과일)' 혹은 '식사+안주(치킨)' 결합을 유도하여 자연스럽게 2만 원 이상의 상위 구간으로 이동시켜야 함.</li>
</ul>
<h4>현장 실행 액션 플랜</h4>
<ul>
<li><strong>즉시 실행 번들 1(치밥 세트):</strong> '밥류 + 치킨' 조합. 매출 기여도가 검증된 조합(약 96만 원)으로, 피크 타임인 18~20시에 집중 진열하여 객단가 2.1만 원대 고정 유도.</li>
<li><strong>즉시 실행 번들 2(프리미엄 과일 팩):</strong> '수박 + 머스크메론' 모듬 세트. 리프트 4.0 이상, 평균 객단가 2.6만 원대의 고단가 조합을 상품화하여 과일 카테고리의 매출 시너지 극대화.</li>
</ul></div>
            </div>
        </div>

        <div class="charts-row">
            <div class="card"><h3>주간 회원 연령대 분포</h3><div class="chart-container"><canvas id="ageChart"></canvas></div></div>
            <div class="card"><h3>주간 회원 방문횟수</h3><div class="chart-container"><canvas id="visitChart"></canvas></div></div>
            <div class="card"><h3>주간 회원 Top 10 카테고리</h3><div class="chart-container"><canvas id="memberCatChart"></canvas></div></div>
            <div class="card"><h3>주간 회원 객단가 분포</h3><div class="chart-container"><canvas id="atvDistChart"></canvas></div></div>
            
            <div class="card">
                <h3>주간 회원 장바구니 통계</h3>
                <div id="basket-container"></div>
            </div>
            <div class="card">
                <h3>주간 회원 나이대별 Top 3 카테고리</h3>
                <div class="table-wrapper"><table id="age-cat-table" class="highlight-first">
                    <thead><tr><th>연령대</th><th>1위</th><th>2위</th><th>3위</th></tr></thead><tbody></tbody>
                </table></div>
            </div>
        </div>

        <div class="card ai-report-section">
            <h3>고객 특성 및 행동 분석</h3>
            <div class="ai-content">
                <div id="ai-space-3"><h4>핵심 고객 페르소나 정의</h4>
<ul>
<li><strong>주력 고객:</strong> 2030세대(회원 중 53% 비중) 여성임. 밥류와 초밥 등 즉석 조리식품 구매가 압도적이며, 16시 이후 방문하여 저녁 식사를 해결하는 '편의성 중시형' 소비 경향을 보임.</li>
<li><strong>틈새 고객:</strong> 4050 중장년층임. 모수는 적으나 복숭아, 초밥 등 고단가 카테고리 구매 비중이 높아 전체 객단가 방어에 기여하는 '고부가가치 실속형' 집단임.</li>
</ul>
<h4>세대별 소비 패턴 및 공략 전략</h4>
<ul>
<li><strong>소비 격차:</strong> 2030은 밥류와 계란 등 식재료 중심이며, 6070은 한식과 수산(회) 등 원물 위주의 장바구니 구성을 보임. 연령이 높을수록 조리된 식품보다 기호 식품 선호도가 뚜렷함.</li>
<li><strong>세대별 전략:</strong> 2030 대상 '밥류+스낵' 야식 번들 할인, 4050 대상 '가족용 모듬초밥 패밀리세트' 증정 프로모션, 6070 대상 '제철 과일(복숭아/토마토) 산지 직송' 홍보를 제안함.</li>
</ul>
<h4>방문 빈도 및 객단가 기반 등급 관리</h4>
<ul>
<li><strong>재방문 유도:</strong> 회원 66%가 주 1회 방문에 머무름. 이들의 재방문 주기를 단축하기 위해 1회 방문 직후 '3일 내 재방문 시 특정 카테고리 10% 할인' 앱 푸시를 발송하여 주 2회 진입을 유도함.</li>
<li><strong>객단가 상승:</strong> 현재 객단가 중앙값은 7,900원으로, 1만 원 장벽이 존재함. 이를 돌파하기 위해 '12,000원 이상 구매 시 계란 또는 신선식품 증정' 행사를 통해 장바구니 단가를 25% 이상 상향 평준화함.</li>
</ul>
<h4>CRM 액션 플랜 (문자 마케팅)</h4>
<ul>
<li><strong>타겟 1(2030 간편식 구매군):</strong> [수영점] 오늘 저녁 뭐 먹지? 고기듬뿍 제육덮밥과 신선한 샐러드가 준비되었습니다. 퇴근길 간편하게 들러보세요!</li>
<li><strong>타겟 2(4050 프리미엄 구매군):</strong> [수영점] 이번 주말 가족 파티! 모듬초밥 패밀리세트와 달콤한 딱딱이 복숭아로 풍성한 식탁을 선물하세요. 지금 매장에서 확인 가능!</li>
</ul></div>
            </div>
        </div>
    </div>

    <script>
        const data = {"문서 제목": "수영점 2025-08-25 주간 매출 분석 보고서", "지점명": "수영점", "주차": "2025-35주차", "주 시작일": "2025-08-25", "주 종료일": "2025-08-31", "영업일수": 7, "주간 총매출": 47587080, "전주 대비 매출 상승율": -3.08, "평균 일일 매출": 6798154, "전주 대비 평균 일일 매출 상승율": -3.08, "평균 일일 거래건수": 713, "전주 대비 거래건수 상승율": -3.52, "평균 일일 객단가": 9535, "전주 대비 객단가 상승율": 0.45, "5주간 매출 추이": {"2025-07-28~2025-08-03,2025-31주차": 17468410, "2025-08-04~2025-08-10,2025-32주차": 44401560, "2025-08-11~2025-08-17,2025-33주차": 45370440, "2025-08-18~2025-08-24,2025-34주차": 49100680, "2025-08-25~2025-08-31,2025-35주차": 47587080}, "요일별 매출(전 주 비교)": {"월요일": {"2025-08-18~2025-08-24": 7198090, "2025-08-25~2025-08-31": 7942190}, "화요일": {"2025-08-18~2025-08-24": 7318170, "2025-08-25~2025-08-31": 7198840}, "수요일": {"2025-08-18~2025-08-24": 7813230, "2025-08-25~2025-08-31": 6422930}, "목요일": {"2025-08-18~2025-08-24": 6816210, "2025-08-25~2025-08-31": 6554220}, "금요일": {"2025-08-18~2025-08-24": 6894630, "2025-08-25~2025-08-31": 7183340}, "토요일": {"2025-08-18~2025-08-24": 7020870, "2025-08-25~2025-08-31": 6476070}, "일요일": {"2025-08-18~2025-08-24": 6039480, "2025-08-25~2025-08-31": 5809490}}, "변동성 카테고리 top 5": [{"카테고리": "수박", "현재_점유율": 5.36, "변동폭": -4.1}, {"카테고리": "계란", "현재_점유율": 8.25, "변동폭": 3.83}, {"카테고리": "기타과일", "현재_점유율": 8.26, "변동폭": 3.61}, {"카테고리": "한식", "현재_점유율": 4.39, "변동폭": 2.17}, {"카테고리": "샐러드", "현재_점유율": 3.99, "변동폭": -2.07}], "변동성 상품 top 5": [{"상품명": "샤인머스켓", "현재_점유율": 8.81, "변동폭": 7.67}, {"상품명": "수박", "현재_점유율": 19.21, "변동폭": -4.16}, {"상품명": "맛있는대란30구", "현재_점유율": 7.63, "변동폭": 4.03}, {"상품명": "머스크메론", "현재_점유율": 11.51, "변동폭": 1.81}, {"상품명": "딱딱이 복숭아", "현재_점유율": 4.04, "변동폭": -1.6}], "주간 시간대별 평균 매출": [{"시간대": "08:00 - 09:59", "총매출": 1691620, "평균매출": 241660, "총거래건수": 227, "평균객단가": 7452}, {"시간대": "10:00 - 11:59", "총매출": 3917400, "평균매출": 559629, "총거래건수": 432, "평균객단가": 9068}, {"시간대": "12:00 - 13:59", "총매출": 5138040, "평균매출": 734006, "총거래건수": 526, "평균객단가": 9768}, {"시간대": "14:00 - 15:59", "총매출": 4127130, "평균매출": 589590, "총거래건수": 450, "평균객단가": 9171}, {"시간대": "16:00 - 17:59", "총매출": 7981300, "평균매출": 1140186, "총거래건수": 784, "평균객단가": 10180}, {"시간대": "18:00 - 19:59", "총매출": 11723440, "평균매출": 1674777, "총거래건수": 1210, "평균객단가": 9689}, {"시간대": "20:00 - 21:59", "총매출": 9258650, "평균매출": 1322664, "총거래건수": 978, "평균객단가": 9467}, {"시간대": "22:00 - 23:59", "총매출": 3749500, "평균매출": 535643, "총거래건수": 384, "평균객단가": 9764}], "주간 Top 10 카테고리 매출": [{"카테고리": "밥류", "순매출금": 4226970, "순수량": 995, "점유율": 21.89}, {"카테고리": "초밥", "순매출금": 2780190, "순수량": 370, "점유율": 14.4}, {"카테고리": "치킨", "순매출금": 2172000, "순수량": 356, "점유율": 11.25}, {"카테고리": "기타과일", "순매출금": 1595200, "순수량": 312, "점유율": 8.26}, {"카테고리": "계란", "순매출금": 1593100, "순수량": 295, "점유율": 8.25}, {"카테고리": "스낵", "순매출금": 1390050, "순수량": 541, "점유율": 7.2}, {"카테고리": "김밥", "순매출금": 1257170, "순수량": 373, "점유율": 6.51}, {"카테고리": "수박", "순매출금": 1035500, "순수량": 243, "점유율": 5.36}, {"카테고리": "한식", "순매출금": 847020, "순수량": 121, "점유율": 4.39}, {"카테고리": "샐러드", "순매출금": 771410, "순수량": 215, "점유율": 3.99}], "요일별 Top5 카테고리": {"월요일": [{"카테고리": "밥류", "순매출금": 698210}, {"카테고리": "초밥", "순매출금": 418000}, {"카테고리": "계란", "순매출금": 334500}, {"카테고리": "치킨", "순매출금": 293600}, {"카테고리": "기타과일", "순매출금": 275300}], "화요일": [{"카테고리": "밥류", "순매출금": 679210}, {"카테고리": "초밥", "순매출금": 427670}, {"카테고리": "치킨", "순매출금": 378400}, {"카테고리": "김밥", "순매출금": 235670}, {"카테고리": "기타과일", "순매출금": 219700}], "수요일": [{"카테고리": "밥류", "순매출금": 555270}, {"카테고리": "초밥", "순매출금": 430620}, {"카테고리": "치킨", "순매출금": 307200}, {"카테고리": "김밥", "순매출금": 232670}, {"카테고리": "한식", "순매출금": 224710}], "목요일": [{"카테고리": "밥류", "순매출금": 648250}, {"카테고리": "초밥", "순매출금": 415930}, {"카테고리": "치킨", "순매출금": 338600}, {"카테고리": "샐러드", "순매출금": 212350}, {"카테고리": "김밥", "순매출금": 207690}], "금요일": [{"카테고리": "밥류", "순매출금": 644730}, {"카테고리": "초밥", "순매출금": 389300}, {"카테고리": "치킨", "순매출금": 327200}, {"카테고리": "계란", "순매출금": 262100}, {"카테고리": "기타과일", "순매출금": 245500}], "토요일": [{"카테고리": "밥류", "순매출금": 507400}, {"카테고리": "기타과일", "순매출금": 329300}, {"카테고리": "초밥", "순매출금": 328540}, {"카테고리": "치킨", "순매출금": 276700}, {"카테고리": "포도", "순매출금": 257000}], "일요일": [{"카테고리": "밥류", "순매출금": 493900}, {"카테고리": "초밥", "순매출금": 370130}, {"카테고리": "치킨", "순매출금": 250300}, {"카테고리": "계란", "순매출금": 234200}, {"카테고리": "김밥", "순매출금": 169270}]}, "주간 시간대별 Top3 카테고리": [{"시간대": "08:00 - 09:59", "카테고리": "김밥", "순매출금": 192360}, {"시간대": "08:00 - 09:59", "카테고리": "밥류", "순매출금": 87890}, {"시간대": "08:00 - 09:59", "카테고리": "계란", "순매출금": 73000}, {"시간대": "10:00 - 11:59", "카테고리": "밥류", "순매출금": 616360}, {"시간대": "10:00 - 11:59", "카테고리": "초밥", "순매출금": 379720}, {"시간대": "10:00 - 11:59", "카테고리": "치킨", "순매출금": 85500}, {"시간대": "10:00 - 11:59", "카테고리": "포도", "순매출금": 85500}, {"시간대": "12:00 - 13:59", "카테고리": "밥류", "순매출금": 762100}, {"시간대": "12:00 - 13:59", "카테고리": "초밥", "순매출금": 294540}, {"시간대": "12:00 - 13:59", "카테고리": "치킨", "순매출금": 198900}, {"시간대": "14:00 - 15:59", "카테고리": "밥류", "순매출금": 310580}, {"시간대": "14:00 - 15:59", "카테고리": "수박", "순매출금": 95900}, {"시간대": "14:00 - 15:59", "카테고리": "치킨", "순매출금": 89100}, {"시간대": "16:00 - 17:59", "카테고리": "초밥", "순매출금": 559660}, {"시간대": "16:00 - 17:59", "카테고리": "밥류", "순매출금": 532850}, {"시간대": "16:00 - 17:59", "카테고리": "치킨", "순매출금": 354600}, {"시간대": "18:00 - 19:59", "카테고리": "밥류", "순매출금": 891460}, {"시간대": "18:00 - 19:59", "카테고리": "초밥", "순매출금": 665490}, {"시간대": "18:00 - 19:59", "카테고리": "치킨", "순매출금": 660300}, {"시간대": "20:00 - 21:59", "카테고리": "밥류", "순매출금": 625170}, {"시간대": "20:00 - 21:59", "카테고리": "기타과일", "순매출금": 396700}, {"시간대": "20:00 - 21:59", "카테고리": "치킨", "순매출금": 355000}, {"시간대": "22:00 - 23:59", "카테고리": "밥류", "순매출금": 206750}, {"시간대": "22:00 - 23:59", "카테고리": "초밥", "순매출금": 92340}, {"시간대": "22:00 - 23:59", "카테고리": "계란", "순매출금": 88100}], "주간 Top 10 상품": [{"상품명": "수박", "순매출금": 1391500, "순수량": 332, "점유율": 19.21}, {"상품명": "머스크메론", "순매출금": 834000, "순수량": 188, "점유율": 11.51}, {"상품명": "고기듬뿍 제육덮밥", "순매출금": 767490, "순수량": 201, "점유율": 10.6}, {"상품명": "모듬초밥패밀리세트", "순매출금": 684900, "순수량": 71, "점유율": 9.46}, {"상품명": "샤인머스켓", "순매출금": 638300, "순수량": 70, "점유율": 8.81}, {"상품명": "맛있는대란30구", "순매출금": 553000, "순수량": 70, "점유율": 7.63}, {"상품명": "연어초밥 8P", "순매출금": 525400, "순수량": 60, "점유율": 7.25}, {"상품명": "모듬초밥 9P", "순매출금": 360350, "순수량": 65, "점유율": 4.97}, {"상품명": "바나나(소)", "순매출금": 336700, "순수량": 98, "점유율": 4.65}, {"상품명": "딱딱이 복숭아", "순매출금": 292800, "순수량": 27, "점유율": 4.04}], "주간 빈도별 연관구매": [{"연관구매": ["밥류", "식빵/일반빵"], "support": 0.02, "lift": 1.325}, {"연관구매": ["밥류", "치킨"], "support": 0.018, "lift": 1.498}, {"연관구매": ["밥류", "스낵"], "support": 0.017, "lift": 1.153}, {"연관구매": ["밥류", "컵라면"], "support": 0.017, "lift": 1.62}, {"연관구매": ["기타과일", "수박"], "support": 0.015, "lift": 4.005}, {"연관구매": ["김밥", "밥류"], "support": 0.014, "lift": 1.372}, {"연관구매": ["간식용빵", "식빵/일반빵"], "support": 0.01, "lift": 4.01}, {"연관구매": ["권장소비자가", "스낵"], "support": 0.01, "lift": 2.59}, {"연관구매": ["김밥", "초밥"], "support": 0.01, "lift": 2.53}, {"연관구매": ["맥주", "소주"], "support": 0.01, "lift": 9.52}], "주간 매출별 연관구매": [{"연관구매": ["밥류", "스낵"], "총매출금": 1041180, "발생횟수": 50}, {"연관구매": ["밥류", "치킨"], "총매출금": 967680, "발생횟수": 46}, {"연관구매": ["기타과일", "수박"], "총매출금": 707910, "발생횟수": 27}, {"연관구매": ["식빵/일반빵", "밥류"], "총매출금": 630610, "발생횟수": 29}, {"연관구매": ["밥류", "김밥"], "총매출금": 542170, "발생횟수": 33}, {"연관구매": ["김밥", "초밥"], "총매출금": 436680, "발생횟수": 12}, {"연관구매": ["샌드위치", "밥류"], "총매출금": 273880, "발생횟수": 7}, {"연관구매": ["샌드위치", "스낵"], "총매출금": 273750, "발생횟수": 7}, {"연관구매": ["밥류", "수박"], "총매출금": 254640, "발생횟수": 7}, {"연관구매": ["밥류", "초밥"], "총매출금": 235600, "발생횟수": 7}], "주간 객단가별 연관구매": {"20000_under": [{"연관구매": ["밥류", "김밥"], "총매출금": 542170, "평균 객단가": 16429}, {"연관구매": ["밥류", "컵라면"], "총매출금": 142230, "평균 객단가": 17778}, {"연관구매": ["밥류", "탄산"], "총매출금": 138180, "평균 객단가": 19740}], "20000_to_40000": [{"연관구매": ["밥류", "스낵"], "총매출금": 1041180, "평균 객단가": 20823}, {"연관구매": ["밥류", "치킨"], "총매출금": 967680, "평균 객단가": 21036}, {"연관구매": ["기타과일", "수박"], "총매출금": 707910, "평균 객단가": 26218}], "40000_over": []}, "주간 회원 방문횟수": {"1회": 423, "2회": 167, "3회": 70, "4회": 32, "5회": 15, "6회": 5, "7회": 4, "8회": 3, "9회": 2, "10회 이상": 1}, "주간 회원 성분포": {"남자": 4, "여자": 718}, "주간 회원 연령대": {"10대": 4, "20대": 228, "30대": 154, "40대": 70, "50대": 58, "60대": 27, "70대": 10, "80대": 3}, "주간 회원 Top 10 카테고리": {"밥류": 1069760, "초밥": 642300, "치킨": 512400, "계란": 497900, "기타과일": 410000, "김밥": 395730, "스낵": 385730, "수박": 383800, "한식": 376680, "샐러드": 285850}, "주간 회원 성별 Top 5 카테고리": {"남": {"밥류": 8980, "감자": 5900, "초밥": 4990, "식빵/일반빵": 1980, "부추": 1700}, "여": {"밥류": 1060780, "초밥": 637310, "치킨": 512400, "계란": 497900, "기타과일": 410000}}, "주간 회원 나이별 Top 3 카테고리": {"10대": {"치킨": 9900, "초밥": 7990, "쓰레기봉투": 6400}, "20대": {"밥류": 314690, "계란": 154100, "기타과일": 148600}, "30대": {"밥류": 202240, "초밥": 150620, "계란": 145600}, "40대": {"밥류": 164830, "초밥": 91610, "복숭아": 69300}, "50대": {"밥류": 95860, "스낵": 63850, "계란": 62100}, "60대": {"한식": 66890, "초밥": 66650, "회": 49500}, "70대 이상": {"밥류": 22000, "복숭아": 21000, "토마토": 19800}}, "주간 회원 장바구니 통계": {"count": 1281.0, "mean": 9614.137392661984, "std": 7546.459666201663, "min": -16290.0, "25%": 4500.0, "50%": 7900.0, "75%": 12490.0, "max": 54680.0}, "주간 회원 객단가 분포": {"1만미만": 826, "1만-3만": 419, "3만-5만": 28, "5만이상": 1}};
        const fmt = (n) => new Intl.NumberFormat('ko-KR').format(Math.round(n));
        const fmtWon = (n) => new Intl.NumberFormat('ko-KR', {style:'currency', currency:'KRW'}).format(n);
        
        // 변동폭 포맷 함수
        const fmtChange = (val) => {
            const color = val >= 0 ? 'up' : 'down';
            const arrow = val >= 0 ? '▲' : '▼';
            return `<span class="${color}">${arrow} ${Math.abs(val)}%</span>`;
        };

        // 헤더 세팅
        document.getElementById('doc-title').innerText = data["문서 제목"];
        document.getElementById('doc-meta').innerHTML = `${data["지점명"]} | ${data["주차"]}<br>기간: ${data["주 시작일"]} ~ ${data["주 종료일"]}`;

        // 통계 주입
        const setStat = (id, val, growthId, growthVal, isWon=true) => {
            const targetEl = document.getElementById(id);
            const growthEl = document.getElementById(growthId);

            // 1. 메인 데이터 출력 (값이 있을 때만)
            if (val !== undefined && val !== null) {
                targetEl.innerText = isWon ? fmtWon(val) : fmt(val) + (id.includes('trx') ? '건' : '');
            } else {
                targetEl.innerText = "-"; // JSON에 데이터 자체가 없을 경우
            }

            // 2. 전주 대비 변동폭 출력 (비교값이 있을 때만)
            if (growthVal !== undefined && growthVal !== null && !isNaN(growthVal)) {
                const color = growthVal >= 0 ? 'color:#e74c3c' : 'color:#3498db';
                const arrow = growthVal >= 0 ? '▲' : '▼';
                growthEl.innerHTML = `전주대비 <span style="${color}; font-weight:bold;">${Math.abs(growthVal)}% ${arrow}</span>`;
            } else {
                growthEl.innerHTML = `<span style="color:#999; font-size:0.8rem;">(전주 데이터 없음)</span>`;
            }
        };
        setStat('total-sales', data["주간 총매출"], 'sales-growth', data["전주 대비 매출 상승율"]);
        setStat('avg-daily-sales', data["평균 일일 매출"], 'avg-sales-growth', data["전주 대비 평균 일일 매출 상승율"]);
        setStat('avg-trx', data["평균 일일 거래건수"], 'trx-growth', data["전주 대비 거래건수 상승율"], false);
        setStat('avg-atv', data["평균 일일 객단가"], 'atv-growth', data["전주 대비 객단가 상승율"]);

        // 차트 설정 생략 (기존 코드 유지)
        new Chart(document.getElementById('fiveWeekChart'), {
            type: 'line',
            data: {
                labels: Object.keys(data["5주간 매출 추이"]).map(k => k.split(',')[1]),
                datasets: [{ label: '매출액', data: Object.values(data["5주간 매출 추이"]), borderColor: '#3498db', fill: true, backgroundColor: 'rgba(52, 152, 219, 0.1)', tension: 0.3 }]
            },
            options: { responsive: true, maintainAspectRatio: false }
        });

        new Chart(document.getElementById('dayCompareChart'), {
            type: 'bar',
            data: {
                labels: Object.keys(data["요일별 매출(전 주 비교)"]),
                datasets: [
                    { label: '지난주', data: Object.keys(data["요일별 매출(전 주 비교)"]).map(d => Object.values(data["요일별 매출(전 주 비교)"][d])[0]), backgroundColor: '#bdc3c7' },
                    { label: '이번주', data: Object.keys(data["요일별 매출(전 주 비교)"]).map(d => Object.values(data["요일별 매출(전 주 비교)"][d])[1]), backgroundColor: '#3498db' }
                ]
            },
            options: { responsive: true, maintainAspectRatio: false }
        });

        new Chart(document.getElementById('hourlyWeeklyChart'), {
            type: 'bar',
            data: {
                labels: data["주간 시간대별 평균 매출"].map(d => d.시간대),
                datasets: [
                    { label: '평균매출', data: data["주간 시간대별 평균 매출"].map(d=>d.평균매출), backgroundColor: '#b0d7ff', yAxisID: 'y', order: 2 },
                    { label: '평균객단가', data: data["주간 시간대별 평균 매출"].map(d=>d.평균객단가), type: 'line', borderColor: '#e74c3c', borderWidth: 3, yAxisID: 'y1', order: 1 }
                ]
            },
            options: { responsive: true, maintainAspectRatio: false, scales: { y1: { position: 'right', grid: { drawOnChartArea: false } } } }
        });

        // 테이블 렌더링
        const renderPivotTable = (tableId, objData) => {
            const tbody = document.querySelector(`#${tableId} tbody`);
            Object.keys(objData).forEach(key => {
                const tr = document.createElement('tr');
                let cells = `<td><strong>${key}</strong></td>`;
                for(let i=0; i<3; i++) {
                    const item = objData[key][i];
                    cells += `<td>${item ? `${item.카테고리 || item.연관구매.join(' + ')}<br><small style="color:#666">(${fmt(item.순매출금 || item.총매출금)}원)</small>` : '-'}</td>`;
                }
                tr.innerHTML = cells;
                tbody.appendChild(tr);
            });
        };

        renderPivotTable('day-top-table', data["요일별 Top5 카테고리"]);
        const hourlyGrouped = data["주간 시간대별 Top3 카테고리"].reduce((acc, curr) => {
            if(!acc[curr.시간대]) acc[curr.시간대] = [];
            acc[curr.시간대].push(curr);
            return acc;
        }, {});
        renderPivotTable('hour-top-table', hourlyGrouped);
        renderPivotTable('atv-assoc-table', data["주간 객단가별 연관구매"]);

        const itemTbody = document.querySelector('#top-item-table tbody');
        data["주간 Top 10 상품"].slice(0, 10).forEach(item => {
            itemTbody.innerHTML += `<tr><td>${item.상품명}</td><td class="text-right">${fmt(item.순매출금)}</td><td class="text-right">${item.순수량}</td></tr>`;
        });

        // --- 변동성 데이터 렌더링 추가 ---
        const volCatTbody = document.querySelector('#vol-cat-table tbody');
        (data["변동성 카테고리 top 5"] || []).forEach(i => {
            volCatTbody.innerHTML += `<tr><td>${i.카테고리}</td><td class="text-right">${i.현재_점유율}%</td><td class="text-right">${fmtChange(i.변동폭)}</td></tr>`;
        });

        const volProdTbody = document.querySelector('#vol-prod-table tbody');
        (data["변동성 상품 top 5"] || []).forEach(i => {
            volProdTbody.innerHTML += `<tr><td>${i.상품명}</td><td class="text-right">${i.현재_점유율}%</td><td class="text-right">${fmtChange(i.변동폭)}</td></tr>`;
        });

        // 나머지 차트 및 기능 (기존 유지)
        const freqTbody = document.querySelector('#assoc-freq-table tbody');
        data["주간 빈도별 연관구매"].slice(0, 5).forEach(item => {
            freqTbody.innerHTML += `<tr><td>${item.연관구매.map(c=>`<span class="badge">${c}</span>`).join('')}</td><td class="text-right">${item.support}</td><td class="text-right">${item.lift}</td></tr>`;
        });
        const salesTbody = document.querySelector('#assoc-sales-table tbody');
        data["주간 매출별 연관구매"].slice(0, 5).forEach(item => {
            salesTbody.innerHTML += `<tr><td>${item.연관구매.map(c=>`<span class="badge">${c}</span>`).join('')}</td><td class="text-right">${fmt(item.총매출금)}</td></tr>`;
        });

        const createDoughnut = (id, obj) => {
            new Chart(document.getElementById(id), {
                type: 'doughnut',
                data: { labels: Object.keys(obj), datasets: [{ data: Object.values(obj), backgroundColor: ['#e74c3c','#3498db','#2ecc71','#f1c40f','#9b59b6','#34495e','#16a085','#27ae60','#2980b9','#8e44ad'] }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'right' } } }
            });
        };
        const weeklyCatObj = data["주간 Top 10 카테고리 매출"].reduce((a, c) => ({...a, [c.카테고리]: c.순매출금}), {});
        createDoughnut('weeklyCatChart', weeklyCatObj);
        createDoughnut('memberCatChart', data["주간 회원 Top 10 카테고리"]);

        const renderBar = (id, obj, label, color) => {
            new Chart(document.getElementById(id), {
                type: 'bar',
                data: { labels: Object.keys(obj), datasets: [{ label: label, data: Object.values(obj), backgroundColor: color }] },
                options: { responsive: true, maintainAspectRatio: false }
            });
        };
        renderBar('ageChart', data["주간 회원 연령대"], '인원수', '#2ecc71');
        renderBar('visitChart', data["주간 회원 방문횟수"], '방문객수', '#9b59b6');
        renderBar('atvDistChart', data["주간 회원 객단가 분포"], '건수', '#f39c12');

        const bs = data["주간 회원 장바구니 통계"];
        document.getElementById('basket-container').innerHTML = `
            <div style="font-size: 1.1rem; margin-bottom: 10px;">분석 대상 총 수량: <strong>${fmt(bs.count)}</strong>개</div>
            <div class="basket-grid">
                <div class="basket-item"><div class="basket-label">평균(객단가)</div><div class="basket-val">${fmtWon(bs.mean)}</div></div>
                <div class="basket-item"><div class="basket-label">25% (하위)</div><div class="basket-val">${fmtWon(bs['25%'])}</div></div>
                <div class="basket-item"><div class="basket-label">50% (중앙)</div><div class="basket-val">${fmtWon(bs['50%'])}</div></div>
                <div class="basket-item"><div class="basket-label">75% (상위)</div><div class="basket-val">${fmtWon(bs['75%'])}</div></div>
                <div class="basket-item"><div class="basket-label">Max</div><div class="basket-val">${fmtWon(bs['max'])}</div></div>
            </div>
        `;

        const ageTbody = document.querySelector('#age-cat-table tbody');
        Object.keys(data["주간 회원 나이별 Top 3 카테고리"]).forEach(age => {
            const cats = data["주간 회원 나이별 Top 3 카테고리"][age];
            let row = `<td><strong>${age}</strong></td>`;
            Object.keys(cats).slice(0,3).forEach(c => row += `<td>${c}<br><small style="color:#666">(${fmt(cats[c])}원)</small></td>`);
            ageTbody.innerHTML += `<tr>${row}</tr>`;
        });
    </script>
</body>
</html>